/**
 * External dependencies
 */
const RemoveEmptyScriptsPlugin = require( 'webpack-remove-empty-scripts' );
const path = require( 'path' );
const defaultConfig = require( '@wordpress/scripts/config/webpack.config' );
const RtlCssPlugin  = require( 'rtlcss-webpack-plugin' );

module.exports = {
	...defaultConfig,

	entry: {
		'index' : path.resolve( process.cwd(), 'src/index.js' ),
		'style' : path.resolve( process.cwd(), 'src/index.scss' ),
		'editor': path.resolve( process.cwd(), 'src/editor.scss' ),
	},
	plugins: [
		...defaultConfig.plugins.filter(
			( filter ) => ! ( filter instanceof RtlCssPlugin )
		),
		
		// Removes the empty `.js` files generated by webpack but
		// sets it after WP has generated its `*.asset.php` file.
		new RemoveEmptyScriptsPlugin( {
			stage: RemoveEmptyScriptsPlugin.STAGE_AFTER_PROCESS_PLUGINS,
		} ),
	]
};